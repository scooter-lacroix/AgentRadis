# 🌟 AgentRadis - 您的AI助手 🤖

[![许可证: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

AgentRadis是一个可扩展的AI代理系统，旨在与各种工具交互的同时保持上下文感知能力。它为构建具有工具调用功能的AI驱动应用程序提供了灵活的框架，并封装在美观直观的界面中。✨

<p align="center">
  <img src="docs/images/banner.txt" alt="AgentRadis 横幅" width="800"/>
</p>

## ✨ 功能特点

- **🔧 工具集成**: 无缝集成各种工具，如文件保存、网络搜索、代码执行和字符串操作
- **🖥️ 多种界面**: 通过网页UI、命令行或API访问
- **🧩 灵活框架**: 构建具有特定工具能力的自定义代理
- **🧠 上下文感知**: 维护对话历史和工具状态
- **🛡️ 错误处理**: 具有信息丰富的反馈的强大错误处理
- **🚀 MCP服务器支持**: 安装和使用模型上下文协议(MCP)服务器以扩展功能
- **🎨 精美UI**: 增强的ASCII横幅、格式化输出和用户友好的显示
- **🔄 实时更新**: 实时进度跟踪和状态更新
- **📝 智能规划**: 智能任务规划和执行
- **🗣️ 语音交互**: 高级语音识别和合成功能
- **🔍 强大的网络搜索**: 多引擎搜索，提供全面结果
- **📄 文本操作**: 强大的字符串编辑和替换功能
- **💻 代码执行**: 安全隔离的Python代码执行

## 🏗️ 革命性架构: 魔法背后的大脑

AgentRadis不仅仅是另一个AI工具—它是一个**完整的认知生态系统**，从零开始构建，具有无与伦比的多功能性和强大功能。我们的尖端架构将最先进的AI与创新工程相结合，创造出一种堪称神奇的体验。

<p align="center">
  <img src="docs/images/architecture.txt" alt="AgentRadis 架构" width="700"/>
</p>

### 🧠 四层智能架构

- **🌟 出色的自适应代理层**
  - **Radis代理**: 皇冠上的明珠—我们的旗舰通用代理，具有先进的推理能力，可适应几乎任何任务
  - **ToolCall代理**: 专业强力代理，以无与伦比的精度执行复杂的工具链
  - **Planning代理**: 我们的战略大师，将复杂问题分解为完美编排的行动计划
  - 每个代理都具有我们专有的**上下文记忆系统™**，能够完美感知正在进行的任务

- **🛠️ 企业级工具层** 
  - 35多种专业工具无缝集成到一个连贯的生态系统中
  - 模块化设计允许零摩擦的无限扩展性
  - 实时工具发现和自主工具获取能力
  - 内置自动错误处理和恢复协议

- **🔌 闪电般快速的API层**
  - 基于工业级FastAPI构建，实现毫秒级响应时间
  - 支持WebSocket实现实时双向通信
  - 企业级身份验证和速率限制
  - 全面的API文档，附带交互式示例

- **💎 令人惊叹的界面层**
  - 值得获奖的响应式设计，在所有设备上完美运行
  - 基于用户偏好的智能暗/亮模式转换
  - 代理推理和工具执行的实时可视化
  - 支持自然语言处理的语音界面

## 🛠️ 超强工具库: 无限可能

AgentRadis配备了一系列**令人惊叹的工具集合**，彻底改变了AI的可能性。每个工具都经过精心打造，以实现最大性能和可靠性，为您提供如同超能力般的功能。

### 🔥 终极文件操作套件
- **📁 FileTool**: 具有军事级安全控制的强大文件操作
- **📝 FileSaver**: 即时内容保存，具有自动格式化和版本控制
- **🔍 FileSearch**: 闪电般快速的全系统文件发现
- **📊 FileStat**: 全面的文件分析和可视化工具

### 🌐 网络智能中心
- **🔎 WebSearch**: 多引擎搜索功能，不遗漏任何信息
- **🧠 WebExtract**: 具有语义理解的高级内容提取
- **📸 WebCapture**: 高保真网站捕获，带有交互元素
- **🔄 WebInteract**: 复杂网络任务的完整浏览器自动化

### 💻 代码执行强力引擎
- **🐍 PythonTool**: 在安全沙盒环境中执行Python代码
- **⚡ JavaScriptTool**: 运行具有完整DOM交互功能的JavaScript
- **📊 DataAnalysisTool**: 通过单个命令处理和可视化复杂数据集
- **🤖 AutomationTool**: 使用最少代码创建复杂工作流

### 🗣️ 高级通信中心
- **🎤 SpeechTool**: 最先进的语音识别和合成
- **🔊 AudioTool**: 全面的音频处理和分析
- **📱 NotificationTool**: 多渠道警报和通知
- **💬 ChatTool**: 同时与多个LLM提供商交互

### 🧩 系统集成大师
- **💻 Terminal**: 精确安全地执行系统命令
- **🐧 Bash**: 运行复杂的bash脚本，具有丰富的输出解析
- **🔌 APITool**: 与外部API交互，具有自动身份验证
- **📡 NetworkTool**: 全面的网络诊断和管理

## 🚀 无限扩展: 超越想象

AgentRadis不仅仅是一个工具—它是一个**活生生的、不断成长的生态系统**，旨在不断发展和扩展。我们的革命性架构允许无限定制和扩展，以满足您能想象的任何挑战。

### 🧩 几分钟内构建您的梦想工具

```python
from app.tool.base import BaseTool

class MyCustomTool(BaseTool):
    name = "my_custom_tool"
    description = "描述您的工具功能"
    parameters = {
        "type": "object",
        "properties": {
            "param1": {
                "type": "string",
                "description": "参数描述"
            }
        },
        "required": ["param1"]
    }
    
    async def run(self, **kwargs) -> dict:
        # 实现您的工具逻辑
        param1 = kwargs.get("param1")
        # 处理参数
        result = f"已处理 {param1}"
        return {
            "status": "success", 
            "result": result
        }
        
    async def cleanup(self):
        # 清理任何资源
        pass
```

### 🌟 自主工具发现与集成

AgentRadis通过其**革命性的MCP应用商店集成**将扩展提升到新的水平。与任何其他AI系统不同，AgentRadis可以：

- **🧠 自主识别何时需要额外能力**并从MCP应用商店请求
- **🔍 根据手头任务动态发现新工具**，无需人工干预
- **⚡ 在几秒钟内安装和集成新工具**，使其立即可用
- **👨‍💻 即时学习如何使用新工具**，无需培训
- **🔄 自动管理工具生命周期**，包括更新和依赖项

只需要求AgentRadis执行需要专门工具的任务，然后惊奇地观察它：

```
用户: "你能分析这些客户评论的情感吗？"

AgentRadis: "我将为您分析这些客户评论的情感。我需要为此任务安装一个专门的工具。"

[AgentRadis自动搜索MCP应用商店]

AgentRadis: "我已在MCP应用商店找到并安装了SentimentAnalyzer工具。现在我将分析您的客户评论..."

[结果片刻后出现]
```

### 🔮 专业任务的自定义代理

使用我们直观的扩展框架创建针对特定领域的专业代理：

```python
from app.agent.toolcall import ToolCallAgent
from app.tool import ToolCollection, WebSearch, FileSaver

class ResearchAgent(ToolCallAgent):
    name = "ResearchAgent"
    description = "专门从事研究任务的代理"
    available_tools = ToolCollection(
        WebSearch(),
        FileSaver()
    )
    system_prompt = "您是一位专注于寻找准确信息的研究助手。"
```

## 🗣️ 语音功能

AgentRadis包含强大的语音识别和合成功能：

### 语音识别
- 实时语音转文本转换
- 多语言支持
- 可配置的灵敏度和静音检测
- 本地模型支持以保护隐私

### 语音合成
- 高质量文本转语音
- 多种语音选项（alloy、echo、fable、onyx、nova、shimmer）
- 速度和音调控制
- 支持SSML高级控制

使用示例：
```python
from app.tool import SpeechTool

# 初始化语音工具
speech = SpeechTool()

# 监听语音
result = await speech.run(
    action="listen",
    timeout=10.0,
    language="zh"
)
print(f"听到: {result['text']}")

# 朗读文本
await speech.run(
    action="speak",
    text="你好，我是AgentRadis！",
    voice="alloy"
)
```

## 🔍 网络搜索功能

AgentRadis包含一个强大的网络搜索系统，它：

- 支持多个搜索引擎（Google、Bing、DuckDuckGo、Brave）
- 组合结果以提供全面覆盖
- 缓存结果以提高性能
- 优雅处理速率限制和错误
- 提供上下文片段以便更好理解
- 在可用时提取结构化数据
- 支持图像搜索功能

使用示例：
```python
from app.tool import WebSearch

# 初始化网络搜索工具
search = WebSearch()

# 执行搜索
result = await search.run(
    query="AI领域的最新发展",
    engine="google",
    num_results=5
)

# 处理结果
for item in result["results"]:
    print(f"标题: {item['title']}")
    print(f"URL: {item['url']}")
    print(f"摘要: {item['snippet']}")
    print("---")
```

## 📝 字符串替换工具

`StrReplaceEditor`工具提供强大的文本操作功能：

- 基本字符串替换
- 正则表达式支持
- 文件内容操作
- 跨多个文件的批处理操作
- 交互式确认模式
- 撤销/重做功能

使用示例：
```python
from app.tool import StrReplaceEditor

# 初始化字符串替换工具
editor = StrReplaceEditor()

# 在单个文件中替换
result = await editor.run(
    action="replace",
    target_file="example.txt",
    pattern="你好",
    replacement="世界",
    use_regex=False
)
print(f"替换次数: {result['count']}")

# 使用正则表达式替换
result = await editor.run(
    action="replace",
    target_file="code.py",
    pattern=r"def (\w+)\(",
    replacement=r"def renamed_\1(",
    use_regex=True
)
```

## 📊 性能和限制

- **内存使用**: 通常需要150-500MB RAM
- **磁盘空间**: 核心安装约200MB，缓存数据需要额外空间
- **API速率限制**: 尊重提供商速率限制，采用指数退避策略
- **工具执行**: 所有工具都有超时保护（默认30秒）
- **Python执行**: 沙盒化，具有内存和时间限制
- **并发操作**: 处理多个同时请求
- **响应大小**: 通过分块和流式处理管理大型响应

## 🔌 API集成

AgentRadis提供全面的API，用于与其他应用程序集成：

```python
import requests
import json

# 基本聊天请求
response = requests.post(
    "http://localhost:5001/api/v1/chat",
    json={
        "prompt": "搜索关于量子计算的信息",
        "stream": False
    },
    headers={"Authorization": "Bearer your-api-key"}
)
result = response.json()

# 工具执行请求
response = requests.post(
    "http://localhost:5001/api/v1/tool",
    json={
        "tool": "web_search",
        "params": {
            "query": "2024年量子计算进展",
            "engine": "google"
        }
    },
    headers={"Authorization": "Bearer your-api-key"}
)
search_result = response.json()

# 流式响应
with requests.post(
    "http://localhost:5001/api/v1/chat",
    json={"prompt": "写一篇关于AI的长文章", "stream": True},
    headers={"Authorization": "Bearer your-api-key"},
    stream=True
) as response:
    for line in response.iter_lines():
        if line:
            chunk = json.loads(line.decode('utf-8'))
            print(chunk["content"], end="", flush=True)
```

## 🙏 致谢

AgentRadis从这些杰出项目中汲取灵感：

- [Langchain](https://github.com/langchain-ai/langchain) - LLM应用程序框架
- [AutoGPT](https://github.com/Significant-Gravitas/AutoGPT) - 一个自主GPT-4实验
- [AgentGPT](https://github.com/reworkd/AgentGPT) - 浏览器中的AI代理

## 🚀 入门指南

### 📋 前提条件

- Python 3.9或更新版本
- pip包管理器
- Node.js和npm（用于MCP服务器支持）

### 🛠️ 安装

我们提供两种安装方法：

#### 方法1: 使用conda 🐍

1. 创建新的conda环境：

```bash
conda create -n agent_radis python=3.12
conda activate agent_radis
```

2. 克隆仓库：

```bash
git clone https://github.com/scooter-lacroix/AgentRadis.git
cd AgentRadis
```

3. 安装依赖：

```bash
pip install -e .  # 以可编辑模式安装
```

#### 方法2: 使用venv 🔄

1. 克隆仓库：

```bash
git clone https://github.com/scooter-lacroix/AgentRadis.git
cd AgentRadis
```

2. 运行设置脚本：

```bash
./run.sh
```

该脚本将自动：
- 如果不存在，创建虚拟环境
- 激活环境
- 安装所有依赖
- 以交互模式启动AgentRadis

### ⚙️ 配置

AgentRadis提供广泛的配置选项，以自定义其行为并与各种LLM提供商和工具集成。该系统设计为可与多个LLM提供商一起工作，包括OpenAI、Anthropic、Azure、Ollama和LM Studio。

1. 在`config`目录中创建`config.toml`文件（可以从示例复制）：

```bash
cp config/config.example.toml config/config.toml
```

2. 编辑`config/config.toml`以添加您的API密钥并自定义设置：

```toml
# 全局LLM配置
[llm]
model = "gpt-4"                # 主要LLM模型
base_url = "https://api.openai.com/v1"  # API端点
api_key = "sk-..."             # 您的API密钥
max_tokens = 4096              # 最大响应长度
temperature = 0.0              # 响应随机性（0.0-2.0）
timeout = 60                   # API请求超时（秒）
retry_attempts = 3             # 失败时重试次数
streaming = true               # 启用流式响应

# 视觉模型配置
[llm.vision]
model = "gpt-4-vision-preview" # 具备视觉能力的模型
base_url = "https://api.openai.com/v1"
api_key = "sk-..."             # 可以与主API密钥不同
max_tokens = 4096
detail_level = "high"          # 图像细节级别（low、medium、high）

# 替代LLM提供商
[llm.providers.anthropic]
enabled = false
model = "claude-3-opus-20240229"
api_key = ""

[llm.providers.azure]
enabled = false
model = "gpt-4"
api_key = ""
endpoint = "https://your-endpoint.openai.azure.com/"
api_version = "2023-05-15"

[llm.providers.local]
enabled = false                # 本地LLM支持
model = "llama3"               # Ollama或类似服务中的模型名称
endpoint = "http://localhost:11434/v1"

# MCP应用商店设置
[mcp]
enabled = true                 # 启用MCP应用商店
server_url = "http://localhost:5004"
install_dir = "./mcp_apps"
auto_update = true             # 自动更新MCP应用
verify_signatures = true       # 验证应用签名以确保安全

# 语音工具设置
[speech]
enabled = true                 # 启用语音功能
stt_model = "tiny.en"          # 语音转文本模型（tiny.en、base.en、large）
stt_engine = "whisper"         # STT引擎（whisper、faster_whisper）
tts_model = "tts-1"            # 文本转语音模型
tts_voice = "alloy"            # 使用的声音（alloy、echo、fable、onyx、nova、shimmer）
auto_transcribe = false        # 自动转录音频输入
language = "zh"                # 默认语言
sample_rate = 16000            # 音频采样率
silence_threshold = 0.1        # 静音检测阈值
silence_duration = 1.0         # 结束录音的静音持续时间（秒）

# 网络搜索配置
[web_search]
enabled = true                 # 启用网络搜索
default_engine = "google"      # 默认搜索引擎
engines = ["google", "bing", "duckduckgo", "brave"]
cache_results = true           # 缓存搜索结果
cache_ttl = 300                # 缓存持续时间（秒）
max_results = 10               # 每次搜索的最大结果数
timeout = 30                   # 搜索超时（秒）
user_agent = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"

# 工具特定设置
[tools]
allow_terminal = true          # 允许终端命令
allow_python_exec = true       # 允许Python代码执行
allow_file_access = true       # 允许文件系统访问
show_hidden_files = false      # 在文件列表中显示隐藏文件
sudo_allowed = false           # 允许sudo命令（谨慎使用）
max_file_size = 10485760       # 处理的最大文件大小（10MB）
restricted_paths = ["/etc", "/var"]  # 访问受限的路径
allowed_python_modules = ["os", "sys", "re", "json", "requests", "numpy", "pandas"] # Python执行允许的模块

# 代理行为设置
[agent]
max_steps = 100                # 最大执行步骤
memory_limit = 50              # 内存中保留的消息数
tool_choice = "auto"           # 工具选择模式：auto、required、none
system_prompt = "您是一个可以访问各种工具的有用AI助手。"
default_agent = "radis"        # 默认代理类型（radis、toolcall、planning）
timeout = 300                  # 代理会话超时（秒）
verbose_logging = true         # 启用详细日志记录
keep_history = true            # 维护对话历史

# 网页界面设置
[web]
enabled = true                 # 启用网页界面
host = "0.0.0.0"               # 绑定主机
port = 5000                    # 监听端口
debug = false                  # 启用调试模式
require_auth = false           # 要求认证
theme = "dark"                 # UI主题（dark、light）
max_upload_size = 52428800     # 最大上传大小（50MB）

# API设置
[api]
enabled = true                 # 启用API服务器
host = "0.0.0.0"               # 绑定主机
port = 5001                    # 监听端口
debug = false                  # 启用调试模式
require_auth = true            # 要求认证
rate_limit = 100               # 每分钟请求数
cors_origins = ["http://localhost:3000", "https://yourapp.com"]

# 日志配置
[logging]
level = "INFO"                 # 日志级别（DEBUG、INFO、WARNING、ERROR）
log_file = "logs/agent.log"    # 日志文件位置
max_size = 10485760            # 最大日志文件大小（10MB）
backup_count = 5               # 保留的备份日志数量
format = "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
```

3. **环境变量支持**: 作为配置文件的替代方案，您可以使用环境变量：

```bash
export RADIS_LLM_API_KEY="sk-your-key-here"
export RADIS_LLM_MODEL="gpt-4"
export RADIS_SPEECH_TTS_VOICE="alloy"
```

4. **高级配置**:
   - `config/tools.toml`: 配置可用工具及其权限
   - `config/prompts.toml`: 自定义不同代理模式的系统提示
   - `config/ui.toml`: 自定义用户界面外观

## 🚀 快速开始

### 💻 命令行选项

`run.sh`脚本提供了几种与AgentRadis交互的方式：

```bash
# 显示帮助和可用选项
./run.sh --help

# 启动网页界面（默认端口5000）
./run.sh --web

# 仅启动API服务器
./run.sh --api

# 显示当前配置
./run.sh --config

# 使用提示在流执行模式下运行
./run.sh --flow "创建一个文件"

# 直接处理提示
./run.sh "搜索猫"

# 交互模式（无参数时默认）
./run.sh
```

### 🌐 网页界面

启动网页界面：

```bash
./run.sh --web
```

然后在浏览器中打开`http://localhost:5000`。网页界面提供：
- 与AgentRadis的实时交互
- 工具执行可视化
- 命令历史
- 上下文感知响应
- 文件上传和下载
- 语音交互功能
- 代码语法高亮

### 🔄 流模式

流模式是一种特殊的执行模式，允许：
- 逐步任务执行
- 更好的错误处理
- 进度跟踪
- 工具状态管理

示例：
```bash
./run.sh --flow "创建一个下载图像的Python脚本"
```

## 👨‍💻 作者

**Stanley Chisango** (@scooter-lacroix)
- 📧 电子邮件: scooterlacroix@gmail.com
- 🌐 GitHub: [scooter-lacroix](https://github.com/scooter-lacroix)

## 📄 许可证

本项目采用MIT许可证 - 详情请参阅[LICENSE](LICENSE)文件。

## 🌟 给我们加星！

如果您发现AgentRadis有用，请考虑在GitHub上给我们加星！这有助于我们成长和改进项目。

## 新功能

### 语音识别和合成

AgentRadis v2现在通过集成RealtimeSTT和RealtimeTTS库包含语音识别和合成功能。这些功能通过MCP应用商店管理。

功能：
- 语音转文本转换
- 具有不同语音选项的文本转语音
- 上下文感知对话
- 多步语音交互

### MCP应用商店

MCP应用商店提供了一种集中方式来发现、安装和管理AgentRadis的工具和功能。

功能：
- 发现可用工具和功能
- 按需安装/卸载工具
- 按功能分类工具
- 搜索特定功能

## 入门指南

### 安装

1. 克隆仓库：
```bash
git clone https://github.com/scooter-lacroix/AgentRadis_v2.git
cd AgentRadis_v2
```

2. 安装依赖：
```bash
pip install -r requirements.txt
```

3. 运行语音工具测试：
```bash
python test_speech.py
```

### 使用语音工具

可以通过Radis API或直接通过工具执行系统访问语音工具：

```python
from app.app import Radis

async def main():
    radis = Radis()
    
    # 文本转语音
    result = await radis.execute_tool("speech", 
        action="speak", 
        text="你好，我是Radis！"
    )
    
    # 语音转文本
    result = await radis.execute_tool("speech",
        action="listen",
        options={"timeout": 5.0}
    )
    
    if result["status"] == "success":
        print(f"您说: {result['text']}")
```

## MCP应用商店使用

MCP应用商店可用于发现和安装新功能：

```python
from app.app import Radis

async def main():
    radis = Radis()
    
    # 获取可用工具
    tools = await radis.get_available_tools()
    
    # 搜索工具
    speech_tools = await radis.search_mcp_tools("speech")
    
    # 安装工具
    result = await radis.install_mcp_tool("realtimestt")
```
